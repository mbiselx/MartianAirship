function rho_atm = atm_density(h, T)
%ATM_DENSITY Ls = 0Â°

data = ...
[2.15E-02	2.08E-02	2.02E-02	1.97E-02	1.94E-02	1.90E-02	1.87E-02	1.84E-02	1.82E-02	1.79E-02	1.77E-02	1.74E-02	1.72E-02	1.70E-02	1.68E-02	1.66E-02	1.63E-02	1.61E-02	1.59E-02	1.57E-02	1.55E-02	1.53E-02	1.51E-02	1.49E-02	1.48E-02	1.46E-02	1.44E-02	1.42E-02	1.40E-02	1.39E-02	1.37E-02	1.35E-02
2.18E-02	2.12E-02	2.06E-02	2.00E-02	1.97E-02	1.94E-02	1.91E-02	1.88E-02	1.85E-02	1.83E-02	1.80E-02	1.78E-02	1.75E-02	1.73E-02	1.71E-02	1.69E-02	1.66E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.44E-02	1.43E-02	1.41E-02	1.39E-02	1.37E-02
2.21E-02	2.15E-02	2.09E-02	2.03E-02	2.00E-02	1.97E-02	1.93E-02	1.90E-02	1.88E-02	1.85E-02	1.83E-02	1.80E-02	1.78E-02	1.75E-02	1.73E-02	1.71E-02	1.69E-02	1.66E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.44E-02	1.42E-02	1.41E-02	1.39E-02
2.24E-02	2.17E-02	2.11E-02	2.05E-02	2.02E-02	1.99E-02	1.96E-02	1.93E-02	1.90E-02	1.87E-02	1.85E-02	1.82E-02	1.80E-02	1.78E-02	1.75E-02	1.73E-02	1.71E-02	1.68E-02	1.66E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.44E-02	1.42E-02	1.40E-02
2.27E-02	2.19E-02	2.13E-02	2.08E-02	2.04E-02	2.01E-02	1.98E-02	1.95E-02	1.92E-02	1.89E-02	1.87E-02	1.84E-02	1.82E-02	1.79E-02	1.77E-02	1.75E-02	1.72E-02	1.70E-02	1.68E-02	1.66E-02	1.63E-02	1.61E-02	1.59E-02	1.57E-02	1.55E-02	1.53E-02	1.51E-02	1.49E-02	1.47E-02	1.45E-02	1.43E-02	1.41E-02
2.29E-02	2.21E-02	2.15E-02	2.10E-02	2.06E-02	2.03E-02	2.00E-02	1.97E-02	1.94E-02	1.91E-02	1.89E-02	1.86E-02	1.84E-02	1.81E-02	1.79E-02	1.76E-02	1.74E-02	1.72E-02	1.69E-02	1.67E-02	1.65E-02	1.63E-02	1.61E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.44E-02	1.42E-02
2.30E-02	2.23E-02	2.17E-02	2.12E-02	2.08E-02	2.05E-02	2.02E-02	1.99E-02	1.96E-02	1.93E-02	1.91E-02	1.88E-02	1.86E-02	1.83E-02	1.81E-02	1.78E-02	1.76E-02	1.74E-02	1.71E-02	1.69E-02	1.67E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.44E-02
2.30E-02	2.25E-02	2.19E-02	2.14E-02	2.11E-02	2.07E-02	2.04E-02	2.01E-02	1.98E-02	1.96E-02	1.93E-02	1.91E-02	1.88E-02	1.85E-02	1.83E-02	1.80E-02	1.78E-02	1.76E-02	1.73E-02	1.71E-02	1.69E-02	1.66E-02	1.64E-02	1.62E-02	1.60E-02	1.57E-02	1.55E-02	1.53E-02	1.51E-02	1.49E-02	1.47E-02	1.45E-02
2.25E-02	2.21E-02	2.17E-02	2.13E-02	2.10E-02	2.07E-02	2.04E-02	2.01E-02	1.98E-02	1.96E-02	1.93E-02	1.91E-02	1.88E-02	1.86E-02	1.83E-02	1.81E-02	1.79E-02	1.76E-02	1.74E-02	1.71E-02	1.69E-02	1.67E-02	1.65E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02
2.18E-02	2.15E-02	2.12E-02	2.09E-02	2.07E-02	2.04E-02	2.02E-02	2.00E-02	1.97E-02	1.95E-02	1.93E-02	1.90E-02	1.88E-02	1.86E-02	1.83E-02	1.81E-02	1.78E-02	1.76E-02	1.74E-02	1.71E-02	1.69E-02	1.67E-02	1.65E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.47E-02	1.45E-02
2.10E-02	2.08E-02	2.05E-02	2.03E-02	2.01E-02	1.99E-02	1.97E-02	1.95E-02	1.92E-02	1.90E-02	1.88E-02	1.86E-02	1.84E-02	1.82E-02	1.79E-02	1.77E-02	1.75E-02	1.73E-02	1.71E-02	1.69E-02	1.66E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.51E-02	1.49E-02	1.47E-02	1.45E-02	1.44E-02
2.02E-02	2.00E-02	1.98E-02	1.96E-02	1.94E-02	1.92E-02	1.90E-02	1.88E-02	1.86E-02	1.84E-02	1.82E-02	1.80E-02	1.78E-02	1.76E-02	1.74E-02	1.72E-02	1.70E-02	1.68E-02	1.66E-02	1.64E-02	1.62E-02	1.61E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.44E-02	1.43E-02	1.41E-02
1.94E-02	1.93E-02	1.91E-02	1.89E-02	1.87E-02	1.85E-02	1.83E-02	1.82E-02	1.80E-02	1.78E-02	1.76E-02	1.74E-02	1.72E-02	1.70E-02	1.69E-02	1.67E-02	1.65E-02	1.63E-02	1.61E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.45E-02	1.43E-02	1.41E-02	1.39E-02	1.37E-02
1.87E-02	1.86E-02	1.84E-02	1.82E-02	1.81E-02	1.79E-02	1.77E-02	1.75E-02	1.74E-02	1.72E-02	1.70E-02	1.68E-02	1.67E-02	1.65E-02	1.63E-02	1.61E-02	1.60E-02	1.58E-02	1.56E-02	1.55E-02	1.53E-02	1.51E-02	1.50E-02	1.48E-02	1.46E-02	1.44E-02	1.42E-02	1.40E-02	1.39E-02	1.37E-02	1.35E-02	1.34E-02
1.82E-02	1.80E-02	1.79E-02	1.77E-02	1.75E-02	1.74E-02	1.72E-02	1.70E-02	1.69E-02	1.67E-02	1.65E-02	1.64E-02	1.62E-02	1.60E-02	1.59E-02	1.57E-02	1.55E-02	1.54E-02	1.52E-02	1.50E-02	1.49E-02	1.47E-02	1.46E-02	1.44E-02	1.42E-02	1.40E-02	1.39E-02	1.37E-02	1.35E-02	1.34E-02	1.32E-02	1.30E-02
1.77E-02	1.76E-02	1.74E-02	1.72E-02	1.71E-02	1.69E-02	1.68E-02	1.66E-02	1.64E-02	1.63E-02	1.61E-02	1.59E-02	1.58E-02	1.56E-02	1.55E-02	1.53E-02	1.51E-02	1.50E-02	1.48E-02	1.47E-02	1.45E-02	1.44E-02	1.42E-02	1.40E-02	1.39E-02	1.37E-02	1.35E-02	1.34E-02	1.32E-02	1.31E-02	1.29E-02	1.27E-02
1.76E-02	1.74E-02	1.72E-02	1.71E-02	1.69E-02	1.67E-02	1.66E-02	1.64E-02	1.62E-02	1.61E-02	1.59E-02	1.57E-02	1.56E-02	1.54E-02	1.53E-02	1.51E-02	1.49E-02	1.48E-02	1.46E-02	1.45E-02	1.43E-02	1.42E-02	1.40E-02	1.38E-02	1.37E-02	1.35E-02	1.33E-02	1.32E-02	1.30E-02	1.29E-02	1.27E-02	1.26E-02
1.76E-02	1.74E-02	1.72E-02	1.71E-02	1.69E-02	1.67E-02	1.65E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.57E-02	1.55E-02	1.53E-02	1.52E-02	1.50E-02	1.48E-02	1.47E-02	1.45E-02	1.43E-02	1.42E-02	1.40E-02	1.38E-02	1.37E-02	1.35E-02	1.33E-02	1.32E-02	1.30E-02	1.29E-02	1.27E-02	1.26E-02	1.24E-02
1.81E-02	1.78E-02	1.76E-02	1.74E-02	1.71E-02	1.69E-02	1.67E-02	1.65E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.51E-02	1.49E-02	1.47E-02	1.45E-02	1.44E-02	1.42E-02	1.40E-02	1.39E-02	1.37E-02	1.35E-02	1.34E-02	1.32E-02	1.31E-02	1.29E-02	1.27E-02	1.26E-02	1.24E-02
1.88E-02	1.84E-02	1.80E-02	1.78E-02	1.75E-02	1.73E-02	1.71E-02	1.68E-02	1.66E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.49E-02	1.47E-02	1.45E-02	1.43E-02	1.42E-02	1.40E-02	1.38E-02	1.37E-02	1.35E-02	1.33E-02	1.32E-02	1.30E-02	1.29E-02	1.27E-02	1.26E-02
1.95E-02	1.89E-02	1.85E-02	1.82E-02	1.79E-02	1.76E-02	1.74E-02	1.71E-02	1.69E-02	1.67E-02	1.65E-02	1.63E-02	1.60E-02	1.58E-02	1.56E-02	1.55E-02	1.53E-02	1.51E-02	1.49E-02	1.47E-02	1.45E-02	1.44E-02	1.42E-02	1.40E-02	1.38E-02	1.37E-02	1.35E-02	1.33E-02	1.32E-02	1.30E-02	1.29E-02	1.27E-02
2.02E-02	1.94E-02	1.90E-02	1.86E-02	1.83E-02	1.80E-02	1.77E-02	1.74E-02	1.72E-02	1.70E-02	1.67E-02	1.65E-02	1.63E-02	1.61E-02	1.59E-02	1.57E-02	1.55E-02	1.53E-02	1.51E-02	1.49E-02	1.48E-02	1.46E-02	1.44E-02	1.42E-02	1.41E-02	1.39E-02	1.37E-02	1.36E-02	1.34E-02	1.32E-02	1.31E-02	1.29E-02
2.07E-02	1.99E-02	1.94E-02	1.89E-02	1.86E-02	1.83E-02	1.80E-02	1.78E-02	1.75E-02	1.73E-02	1.70E-02	1.68E-02	1.66E-02	1.64E-02	1.62E-02	1.60E-02	1.58E-02	1.56E-02	1.54E-02	1.52E-02	1.50E-02	1.48E-02	1.46E-02	1.45E-02	1.43E-02	1.41E-02	1.39E-02	1.38E-02	1.36E-02	1.34E-02	1.33E-02	1.31E-02
2.11E-02	2.04E-02	1.98E-02	1.93E-02	1.90E-02	1.87E-02	1.84E-02	1.81E-02	1.78E-02	1.76E-02	1.74E-02	1.71E-02	1.69E-02	1.67E-02	1.65E-02	1.63E-02	1.61E-02	1.58E-02	1.56E-02	1.55E-02	1.53E-02	1.51E-02	1.49E-02	1.47E-02	1.45E-02	1.43E-02	1.42E-02	1.40E-02	1.38E-02	1.36E-02	1.35E-02	1.33E-02
2.15E-02	2.08E-02	2.02E-02	1.97E-02	1.94E-02	1.90E-02	1.87E-02	1.84E-02	1.82E-02	1.79E-02	1.77E-02	1.74E-02	1.72E-02	1.70E-02	1.68E-02	1.66E-02	1.63E-02	1.61E-02	1.59E-02	1.57E-02	1.55E-02	1.53E-02	1.51E-02	1.49E-02	1.48E-02	1.46E-02	1.44E-02	1.42E-02	1.40E-02	1.39E-02	1.37E-02	1.35E-02 ];



    idx = 35*(h+5000)/5000 - 3;
    assert(all(idx >=1), "this is below the minimum altitude")
    rho_atm = ((1-rem(idx,1)).*data(T, floor(idx)) + rem(idx,1).*data(T, ceil(idx)))/2;

end

% figure, plot(0:-100:-4400, atm_density(0:-100:-4400, 12))
% hold on, plot(0:-100:-4400, -7e-7*(0:-100:-4400)+7e-3), hold off
